# ===========================================
# API SETTINGS
# ===========================================

API_PORT=7555
DEBUG=false

# OCR Settings
OCR_LANGUAGES=rus+eng

# Processing Settings
PROCESSING_TIMEOUT_SECONDS=300

# ===========================================
# PERFORMANCE SETTINGS
# ===========================================

# Number of CPU cores on the server
CPU_CORES=4

# Number of uvicorn worker processes
# Development: 1, Production: 2 * CPU_CORES + 1
WORKERS=1

# ===========================================
# ALL SIZE/MEMORY SETTINGS ARE IN MEGABYTES
# ===========================================

# ===========================================
# FILE PROCESSING (MB)
# ===========================================

# Maximum file size (MB)
MAX_FILE_SIZE_MB=20

# Maximum archive size (MB)
MAX_ARCHIVE_SIZE_MB=20

# Maximum extracted content size (MB)
MAX_EXTRACTED_SIZE_MB=100

# Maximum archive nesting depth
MAX_ARCHIVE_NESTING=3

# ===========================================
# CONTAINER MEMORY LIMITS (MB)
# ===========================================

# Maximum memory for the entire container (MB)
# Container will be restarted when exceeded
# Recommended: 2048 small, 4096 medium, 8192 large
MAX_MEMORY_MB=2048

# Request limit for automatic uvicorn worker restart
# Helps release accumulated memory from leaks
# 0 = no limit (NOT RECOMMENDED)
UVICORN_LIMIT_MAX_REQUESTS=1000

# ===========================================
# SUBPROCESS MEMORY LIMITS (MB)
# ===========================================

# Enable/disable resource limits for child processes
ENABLE_RESOURCE_LIMITS=true

# Maximum memory for child processes (MB)
MAX_SUBPROCESS_MEMORY_MB=1024

# Maximum memory for LibreOffice (MB)
MAX_LIBREOFFICE_MEMORY_MB=1536

# Maximum memory for Tesseract OCR (MB)
MAX_TESSERACT_MEMORY_MB=512

# Maximum resolution for OCR images (pixels)
MAX_OCR_IMAGE_PIXELS=52428800

# ===========================================
# MEMORY CONFIGURATION RECOMMENDATIONS
# ===========================================

# For small systems (2-4GB RAM):
# MAX_MEMORY_MB=1536
# MAX_SUBPROCESS_MEMORY_MB=512
# MAX_LIBREOFFICE_MEMORY_MB=1024
# MAX_TESSERACT_MEMORY_MB=256

# For medium systems (8-16GB RAM):
# MAX_MEMORY_MB=2048
# MAX_SUBPROCESS_MEMORY_MB=1024
# MAX_LIBREOFFICE_MEMORY_MB=2048
# MAX_TESSERACT_MEMORY_MB=512

# For large systems (32GB+ RAM):
# MAX_MEMORY_MB=8192
# MAX_SUBPROCESS_MEMORY_MB=2048
# MAX_LIBREOFFICE_MEMORY_MB=4096
# MAX_TESSERACT_MEMORY_MB=1024

# Logging
LOG_LEVEL=INFO

# ===========================================
# WEB EXTRACTOR SETTINGS
# ===========================================

# Minimum image size for OCR (pixels, width * height)
MIN_IMAGE_SIZE_FOR_OCR=22500

# Maximum images to process per web page
MAX_IMAGES_PER_PAGE=20

# Web page load timeout (seconds)
WEB_PAGE_TIMEOUT=30

# Image download timeout (seconds)
IMAGE_DOWNLOAD_TIMEOUT=15

# Default User-Agent for web requests
DEFAULT_USER_AGENT="Text Extraction Bot 1.0"

# Enable JavaScript execution (requires Playwright)
ENABLE_JAVASCRIPT=false

# Blocked IP ranges for SSRF protection
BLOCKED_IP_RANGES="127.0.0.0/8,10.0.0.0/8,172.16.0.0/12,192.168.0.0/16,169.254.0.0/16,::1/128,fe80::/10"

# Blocked hostnames
BLOCKED_HOSTNAMES="localhost,host.docker.internal,ip6-localhost,ip6-loopback"

# ===========================================
# PLAYWRIGHT SETTINGS
# ===========================================

# Enable base64 image support
ENABLE_BASE64_IMAGES=true

# Delay after JavaScript load (seconds)
WEB_PAGE_DELAY=3

# Enable lazy loading (auto-scroll)
ENABLE_LAZY_LOADING_WAIT=true

# JS rendering timeout (seconds)
JS_RENDER_TIMEOUT=10

# Maximum scroll attempts for lazy loading
MAX_SCROLL_ATTEMPTS=3